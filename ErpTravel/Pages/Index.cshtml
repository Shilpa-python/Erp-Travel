@page
@model IndexModel
@{
    ViewData["Title"] = "Travel Agency ERP";
}

<h1>Company Name</h1>
<div class="container">
    <div class="form-container">
        <form method="post" asp-page="/Quotation" id="bookingForm">

            <div>
                <!-- Non-changeable label for Destination Management Company -->
                <h3>Destination Management Company</h3>
            </div>

            <div>
                <!-- Label and input for Agency Name -->
                <label for="AgencyName">Agency Name:</label>
                <input type="text" id="AgencyName" name="AgencyName" />
            </div>

            <div>
                <!-- Label and input for Agency Location -->
                <label for="AgencyLocation">Location:</label>
                <input type="text" id="AgencyLocation" name="AgencyLocation" />
            </div>
            <div>
                <!-- Label and input for Agency Number -->
                <label for="AgencyNumber">Contact Number:</label>
                <input type="tel" id="AgencyNumber" name="AgencyNumber" />
            </div>
      
         <label for="adults">Number of Adults</label>
            <input type="number" id="adults" name="Adults" required oninput="updateVehicleSuggestion(); updateItinerary();" />

         <label for="children">Number of Children</label>
            <input type="number" id="children" name="Children" min="0" required oninput="updateVehicleSuggestion(); updateItinerary();" />

            <div>
                <!-- Label and input for Nights (Days calculated automatically based on Nights) -->
                <label for="Nights">Number of Nights:</label>
                <input type="number" id="Nights" name="Nights" value="1" min="1" oninput="calculateDays()" />


                <!-- Hidden field to store days -->
                <input type="hidden" id="Days" name="Days" required oninput="updateVehicleSuggestion(); updateItinerary();" />
            </div>

            <div>
                <!-- Label for Arrival Date -->
                <label for="ArrivalDate">Arrival Date:</label>
                <input type="date" id="ArrivalDate" name="ArrivalDate" />
            </div>

 
    <h4>Hotel Room Booking</h4>

    <label for="rooms">Number of Rooms</label>
    <input type="number" id="rooms" name="Rooms" min="1" max="100" required oninput="calculateTotal()" />

    <label for="cwb">Number of Children with Bed</label>
    <input type="number" id="cwb" name="ChildrenWithBed" />

    <label for="cwob">Number of Children without Bed</label>
    <input type="number" id="cwob" name="ChildrenWithoutBed" />

    <label for="extraBeds">Number of Extra Beds</label>
    <input type="number" id="extraBeds" name="ExtraBeds" />

    <label for="room">Room Type</label>
    <select id="room" name="RoomType" onchange="calculateTotal()">
        <option value="Select">Select</option>
        <option value="Superior" data-price="1500">Superior room - INR 1500</option>
        <option value="Deluxe" data-price="2000">Deluxe room - INR 2000</option>
        <option value="Deluxe prem" data-price="2500">Deluxe Premiere room - INR 2500</option>
        <option value="Fam suite" data-price="3000">Family suite - INR 3000</option>
    </select>

    <label>Total Amount :</label>
    <span id="totalAmount">INR 0</span>
    <input type="hidden" id="totalAmountHidden" name="TotalRoomAmount" />
    <br><br>

    <h4>Transportation</h4>

    <label for="vehicle">Suggested Vehicle</label>
    <select id="vehicle" name="Vehicle" required readonly>
               <!-- This will be filled automatically based on total number of people -->
    </select>

    <input type="hidden" id="suggestedVehicleHidden" name="SuggestedVehicle" />


    <p id="vehicle-rent"></p>
    <input type="hidden" id="vehicleRentHidden" name="TotalVehicleRent" /><!-- Display vehicle rent per day -->

    <h4>Select Itinerary</h4>
            <label for="itineraryType">Itinerary Selection Method:</label>
            <select id="itineraryType" name="ItineraryType" onchange="toggleItineraryMode();">
                <option value="auto">Auto-generate Itinerary Based on Days</option>
                <option value="manual">Select from Predefined Itinerary</option>
            </select>

            <div id="predefinedItinerarySection" style="display: none;">
                <label for="itinerarySelect">Choose a Predefined Itinerary:</label>
                <select id="itinerarySelect" name="Itinerary" onchange="updateItineraryDisplay();">
                    <option value="">Select Itinerary</option>
                    <option value="Itinerary1">Itinerary 1: City Tour & Cultural</option>
                    <option value="Itinerary2">Itinerary 2: Adventure & Nature</option>
                    <option value="Itinerary3">Beach & Relaxation</option>
                </select>
            </div>
            

            <div id="itineraryDisplay"></div>

    <input type="submit" value="Submit" />

    
</form>
</div>


    
       
    

</div>

<style>
    .container {
        display: flex;
        justify-content: flex-start;
        margin-top: 20px;
    }

    .form-container {
        flex: 1; /* Takes up available space */
        padding-right: 20px; /* Space between form and itinerary */
    }

    
</style>


<script>
    function calculateDays() {
        var nights = parseInt(document.getElementById('Nights').value) || 0;
        var days = parseInt(nights) + 1; // Add 1 to nights to get days
        document.getElementById('Days').value = days; // Set hidden days value

        // Call vehicle update after days are calculated
        updateVehicleSuggestion();
    }
    function calculateTotal() {
        // Get the values from the form
        var rooms = parseInt(document.getElementById("rooms").value) || 0;

        var nights = parseInt(document.getElementById("Nights").value) || 0;

        var cwb = parseInt(document.getElementById("cwb").value) || 0;
        var pricePerBed = 150; // Assuming price for each bed; update as needed
        var totalCWB = cwb * pricePerBed; // Calculate total for children with bed

        var extraBeds = parseInt(document.getElementById("extraBeds").value) || 0;
        var totalExtraBeds = extraBeds * pricePerBed;
        // Calculate the total cost

        var roomSelect = document.getElementById("room");
        var pricePerRoom = parseFloat(roomSelect.options[roomSelect.selectedIndex].getAttribute('data-price')) || 0;

        var totalAmount = (rooms * pricePerRoom * nights) + totalCWB + totalExtraBeds ;

        // Display the total amount
        document.getElementById("totalAmount").textContent = "INR " + totalAmount.toFixed(2);
        document.getElementById("totalAmountHidden").value = totalAmount;
    }

    function updateVehicleSuggestion() {
        var days = parseInt(document.getElementById("Days").value) || 0;
        var adults = parseInt(document.getElementById("adults").value) || 0;
        var children = parseInt(document.getElementById("children").value) || 0;

        var totalPeople = adults + children;

        var vehicleOptions = {
            car: { label: "Car", rentPerDay: 500 },
            suv: { label: "SUV", rentPerDay: 800 },
            minivan: { label: "Mini Van", rentPerDay: 1000 },
            bus: { label: "Bus", rentPerDay: 1500 }
        };

        let suggestedVehicle;
        if (totalPeople <= 4) {
            suggestedVehicle = vehicleOptions.car;
        } else if (totalPeople === 5) {
            suggestedVehicle = vehicleOptions.suv;
        } else if (totalPeople === 6 || totalPeople === 7) {
            suggestedVehicle = vehicleOptions.minivan;
        } else {
            suggestedVehicle = vehicleOptions.bus;
        }

        var vehicleSelect = document.getElementById("vehicle");
        vehicleSelect.innerHTML = `<option value="${suggestedVehicle.label}">${suggestedVehicle.label}</option>`;

        document.getElementById("suggestedVehicleHidden").value = suggestedVehicle.label;

        // Calculate the total vehicle rent
        var vehicleRent = suggestedVehicle.rentPerDay * days;
        document.getElementById("vehicle-rent").textContent = `Vehicle Rent per Day: ${suggestedVehicle.rentPerDay}. Total Rent for ${days} day(s): ${vehicleRent}`;
        document.getElementById("vehicleRentHidden").value = vehicleRent;
    }

    function toggleItineraryMode() {
        var itineraryType = document.getElementById("itineraryType").value;
        var predefinedItinerarySection = document.getElementById("predefinedItinerarySection");
        if (itineraryType === "manual") {
            predefinedItinerarySection.style.display = "block";
            document.getElementById("itineraryDisplay").innerHTML = "";
        } else {
            predefinedItinerarySection.style.display = "none";
            generateItinerary();
        }
    }

    function generateItinerary() {
        var days = parseInt(document.getElementById("Days").value) || 0;
        var itineraryDisplay = document.getElementById("itineraryDisplay");
        if (document.getElementById("itineraryType").value === "manual") return;

        itineraryDisplay.innerHTML = "";
        var itineraryTemplate = [
            "Day 1: Arrival and transfer to the hotel.",
            "Day 2: City tour - Visit landmarks and cultural sites.",
            "Day 3: Explore local markets and shopping districts.",
            "Day 4: Relaxation day at the beach or local park.",
            "Day 5: Adventure day - Outdoor activities.",
            "Day 6: Final day - Departure."
        ];

        for (var i = 0; i < days; i++) {
            var dayText = itineraryTemplate[i] || `Day ${i + 1}: Custom itinerary for this day.`;
            itineraryDisplay.innerHTML += `<p>${dayText}</p>`;
        }
    }

    function updateItinerary() {
        generateItinerary();
    }

    function updateItineraryDisplay() {
        var days = parseInt(document.getElementById("Days").value) || 0;
        var itinerarySelect = document.getElementById("itinerarySelect").value;
        var itineraryDisplay = document.getElementById("itineraryDisplay");
        
        itineraryDisplay.innerHTML = "";
        
       

        if (itinerarySelect === "Itinerary1") {
            // Create Itinerary 1
            for (var i = 0; i < days; i++) {
                if (i === 0) {
                    itineraryDisplay.innerHTML += `<p>Day 1: Arrival and City Tour.</p>`;
                } else if (i === 1) {
                    itineraryDisplay.innerHTML += `<p>Day 2: Cultural visits and Museums.</p>`;
                } else if (i === 2) {
                    itineraryDisplay.innerHTML += `<p>Day 3: Departure.</p>`;
                } else {
                    itineraryDisplay.innerHTML += `<p>Day ${i + 1}: Free day for personal exploration.</p>`;
                }
            }
        } else if (itinerarySelect === "Itinerary2") {
            // Create Itinerary 2
            for (var i = 0; i < days; i++) {
                if (i === 0) {
                    itineraryDisplay.innerHTML += `<p>Day 1: Adventure Trek.</p>`;
                } else if (i === 1) {
                    itineraryDisplay.innerHTML += `<p>Day 2: Nature walk and Safari.</p>`;
                } else if (i === 2) {
                    itineraryDisplay.innerHTML += `<p>Day 3: Departure.</p>`;
                } else {
                    itineraryDisplay.innerHTML += `<p>Day ${i + 1}: Optional adventure activities.</p>`;
                }
            }
        } else if (itinerarySelect === "Itinerary3") {
            // Create Itinerary 3
            for (var i = 0; i < days; i++) {
                if (i === 0) {
                    itineraryDisplay.innerHTML += `<p>Day 1: Relax on the Beach.</p>`;
                } else if (i === 1) {
                    itineraryDisplay.innerHTML += `<p>Day 2: Explore the Coastal town.</p>`;
                } else if (i === 2) {
                    itineraryDisplay.innerHTML += `<p>Day 3: Departure.</p>`;
                } else {
                    itineraryDisplay.innerHTML += `<p>Day ${i + 1}: Leisure activities by the beach.</p>`;
                }
            }
        }
    }



    // Initial calculation on page load
    window.onload = function () {

        calculateDays();
        calculateTotal();
        updateVehicleSuggestion();
        updateItinerary(); // Initialize the itinerary
    };

</script>

